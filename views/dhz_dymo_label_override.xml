<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="dhz_dymo_label_override" model="ir.ui.view">
    <field name="name">DHZ – Etichetă LPN + QR</field>
    <field name="inherit_id" ref="product.report_simple_label_dymo"/>
    <field name="priority" eval="99"/>
    <field name="active" eval="1"/>
    <field name="arch" type="xml">
      <xpath expr="//*[contains(concat(' ', normalize-space(@class), ' '), ' o_label_full ')]" position="replace">
        <!-- Setări utile -->
        <t t-set="tmpl" t-value="product.product_tmpl_id if (product._name == 'product.product') else product"/>
        <t t-set="qr_url" t-value="'https://www.dhz.ro/shop/%s' % tmpl.id"/>

        <div class="o_label_full" style="width:55mm; height:55mm; padding:0.5mm; font-size:8pt; line-height:1.0;">
          <!-- Tabel cu QR și text -->
          <table style="width:100%; margin-bottom:0.5mm;">
            <tr>
              <!-- Coloană QR -->
              <td style="width:18mm; text-align:left; vertical-align:top;">
                <div t-out="qr_url"
                     t-options="{
                       'widget': 'barcode',
                       'symbology': 'QR',
                       'humanreadable': 0,
                       'quiet': 1,
                       'img_style': 'width:18mm; height:18mm;'
                     }"/>
              </td>

              <!-- Coloană text -->
              <td style="padding-left:0.5mm; font-size:6pt; text-align:center; vertical-align:middle;">
                <div>
                  <strong>Scanează QR pentru preț și detalii</strong>
                </div>
              </td>
            </tr>
          </table>

          <!-- Etichetă 60x60mm -->
          <t t-name="product.label.60x60.custom">
            <div class="page"
                 style="width:100%; padding:0mm;
                        display:flex; flex-direction:column; justify-content:flex-start;
                        text-align:left; font-size:12pt; line-height:1.0;">

              <!-- SUS: Titlul produsului -->
              <div style="width:100%; max-height:18mm; overflow:hidden; word-wrap:break-word; margin-bottom:1mm;">
                <t t-set="name_length" t-value="len(product.name or '')"/>
                <div style="font-weight:bold; line-height:1.0;">
                  <t t-if="name_length &lt;= 40">
                    <span style="font-size:10pt;" t-esc="product.name"/>
                  </t>
                  <t t-if="name_length &gt; 40 and name_length &lt;= 80">
                    <span style="font-size:8pt;" t-esc="product.name"/>
                  </t>
                  <t t-if="name_length &gt; 80">
                    <span style="font-size:6pt;" t-esc="product.name"/>
                  </t>
                </div>
              </div>

              <!-- JOS: Cod de bare + text LPN -->
              <t t-if="product.x_studio_lpn_code">
                <div style="width:100%;">
                  <div t-out="product.x_studio_lpn_code"
                       t-options="{
                         'widget': 'barcode',
                         'symbology': 'Code128',
                         'humanreadable': 0,
                         'quiet': 0,
                         'img_style': 'width:100%; height:7mm;'
                       }"/>
                  <div style="text-align:center; font-size:7pt; margin-top:0.3mm;">
                    <strong><span t-out="product.x_studio_lpn_code"/></strong>
                  </div>
                </div>
              </t>

              <t t-if="not product.x_studio_lpn_code">
                <div style="font-size:7pt; opacity:0;">LPN indisponibil</div>
              </t>

            </div>
          </t>

        </div>
      </xpath>
    </field>
  </record>
</odoo>
